@page "/country"
@using Microsoft.Extensions.Options
@using TransfermarktScraper.Web.Clients.Interfaces
@using TransfermarktScraper.Web.Configuration
@attribute [StreamRendering(true)]

@inject ICountryClient CountryClient
@inject IOptions<ClientSettings> ClientSettings

<PageTitle>Countries</PageTitle>

@if (countries == null)
{
    <MudText HtmlTag="em">Scraping countries please wait...</MudText>
}
else
{
    <MudGrid Spacing="4" Justify="Justify.FlexStart">
        @foreach (var country in countries)
        {
            <MudItem>
                <MudLink Href="@($"{ClientSettings.Value.CountryControllerPath}/{country.TransfermarktId}")">
                    <MudPaper Elevation="5">
                        <MudImage Src="@country.Flag" Alt="@country.Name" />
                        <MudText Typo="Typo.body2" Align="Align.Center">@country.Name</MudText>
                    </MudPaper>
                </MudLink>
            </MudItem>
        }
    </MudGrid>
}

@code {
	private IEnumerable<Domain.DTOs.Response.Country>? countries;

    protected override async Task OnInitializedAsync()
    {
        countries = await CountryClient.GetCountriesAsync();
    }
}
